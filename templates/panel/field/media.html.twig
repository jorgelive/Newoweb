{#
Template Genérico Multimedia para EasyAdmin (Panel).
Ubicación: templates/panel/field/media.html.twig

Lógica:
1. Si es imagen: Muestra miniatura (LiipImagine) + Lightbox.
2. Si es archivo: Muestra icono representativo (Word, PDF, Excel, etc).

Uso en CrudController:
yield TextField::new('archivoName')
    ->setTemplatePath('panel/field/media.html.twig')
    ->setCustomOption('base_path', 'uploads/tu/carpeta/especifica');
#}

{% if field.value %}
    {# --- 1. Preparación de Variables --- #}
    {% set extension = field.value|split('.')|last|lower %}

    {# Extensiones que trataremos como fotos (Thumbnail + Zoom) #}
    {% set is_image = extension in ['jpg', 'jpeg', 'png', 'gif', 'webp', 'heic', 'avif'] %}

    {# Recuperamos la ruta base que pasaste desde el Controller #}
    {% set base_dir = field.customOptions.get('base_path') %}

    {# Ruta web completa #}
    {% set web_path = base_dir ~ '/' ~ field.value %}

    {# --- 2. Renderizado --- #}
    <div class="d-flex justify-content-center align-items-center">

        {% if is_image %}
            {# A. IMAGEN: Miniatura visual con LiipImagine #}
            <a href="{{ asset(web_path) }}" class="ea-lightbox-thumbnail" data-fslightbox="gallery-{{ field.uniqueId }}">
                {#
                Usamos el filtro 'pms_thumb_admin' (o el nombre que hayas puesto en liip.yaml).
                Genera un cuadrado de 150x150 px.
                #}
                <img src="{{ asset(web_path) | imagine_filter('pms_thumb_admin') }}"
                     class="img-fluid rounded border shadow-sm"
                     style="width: 50px; height: 50px; object-fit: cover;"
                     alt="{{ field.formattedValue }}"
                     loading="lazy" />
            </a>

        {% else %}
            {# B. DOCUMENTO: Icono según extensión (Coincide con MediaTrait) #}
            {% set icon_map = {
                'pdf':  'pdf.png',
                'doc':  'word.png', 'docx': 'word.png',
                'xls':  'excel.png', 'xlsx': 'excel.png',
                'ppt':  'powerpoint.png', 'pptx': 'powerpoint.png',
                'txt':  'text.png',
                'zip':  'compressed.png', 'rar': 'compressed.png', '7z': 'compressed.png',
                'mp3':  'music.png', 'wav': 'music.png',
                'mp4':  'movie.png', 'avi': 'movie.png', 'mov': 'movie.png'
            } %}

            {# Si no es ninguno de los anteriores, mostramos developer.png #}
            {% set icon_name = icon_map[extension] ?? 'developer.png' %}

            <a href="{{ asset(web_path) }}" target="_blank" title="Descargar {{ extension|upper }}" class="text-decoration-none transition-transform">
                <img src="{{ asset('app/icons/' ~ icon_name) }}"
                     style="width: 40px; height: 40px;"
                     alt="Archivo {{ extension }}" />
            </a>
        {% endif %}

    </div>
{% else %}
    {# 3. Estado Vacío #}
    <span class="badge badge-light text-muted" style="opacity: 0.5;">-</span>
{% endif %}