liip_imagine:
    # Usamos imagick (asegúrate de que tu Docker lo tenga, si no usa "gd")
    driver: "imagick"

    resolvers:
        default:
            web_path:
                web_root: "%kernel.project_dir%/public"
                cache_prefix: "media/cache"

    filter_sets:
        # --- FILTRO 1: COMPRESIÓN INICIAL ---
        pms_compress_initial:
            quality: 80
            format: webp  # ✅ CORRECTO: Va aquí afuera, no dentro de 'filters'
            filters:
                downscale: { max: [1600, 1600] }
                strip: ~

        # --- FILTRO 2: THUMBNAIL ADMIN ---
        pms_thumb_admin:
            quality: 75
            format: webp  # ✅ CORRECTO: Define el formato de salida del set
            filters:
                thumbnail: { size: [150, 150], mode: outbound, allow_upscale: true }
                # ❌ ELIMINA: format: { name: webp } de aquí adentro